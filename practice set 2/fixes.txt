fixing the first bug.

fix 2nd bug.

fix 3rd bug

fix another bug.